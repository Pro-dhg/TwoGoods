package com.yamu.data.sample.service.resources.mapper;

import com.yamu.data.sample.service.resources.entity.bo.AnswerDistributionBO;
import com.yamu.data.sample.service.resources.entity.po.AnswerDistribution;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Select;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
public interface AnswerDistributionMapper {

    @Select("<script>"
            + "select * from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "</script>")
    List<AnswerDistribution> findBySelective(@Param("queryParam") AnswerDistributionBO queryParam);

    @Select("<script>"
            + "select province, SUM(parse_total_cnt) as parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by province"
            + "</script>")
    List<AnswerDistribution> findInfoGroupByProvince(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select case when city='辖区' then district else city end as city, SUM(parse_total_cnt) as parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by case when city='辖区' then district else city end as city"
            + "</script>")
    List<AnswerDistribution> findInfoGroupByCity(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select parse_time, province, SUM(parse_total_cnt) AS parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by(parse_time, province)"
            + "</script>")
    List<AnswerDistribution> findBySelectiveGroupByParseTimeAndProvince(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select parse_time, case when city='辖区' then district else city end as city, SUM(parse_total_cnt) AS parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by(parse_time, case when city='辖区' then district else city end as city)"
            + "</script>")
    List<AnswerDistribution> findBySelectiveGroupByParseTimeAndCity(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select parse_time from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by parse_time order by parse_time limit #{queryParam.offset},#{queryParam.limit}"
            + "</script>")
    List<String> pageByParseTime(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select parse_time, province, SUM(parse_total_cnt) AS parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by(parse_time, province) order by parse_time desc limit #{queryParam.offset} , #{queryParam.limit}"
            + "</script>")
    List<AnswerDistribution> findBySelectiveGroupByParseTimeAndProvinceLimitNum(@Param("queryParam") AnswerDistributionBO queryParam);

    @Select("<script>"
            + "select parse_time, case when city='辖区' then district else city end as city, SUM(parse_total_cnt) AS parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by(parse_time, case when city='辖区' then district else city end as city) order by parse_time desc limit #{queryParam.offset} , #{queryParam.limit}"
            + "</script>")
    List<AnswerDistribution> findBySelectiveGroupByParseTimeAndCityLimitNum(@Param("queryParam") AnswerDistributionBO queryParam);

    @Select("<script>"
            + "select count(1) from ("
            + "select parse_time from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by parse_time"
            + ")"
            + "</script>")
    Long countPageByParseTime(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select province, isp, SUM(parse_total_cnt) as parse_total_cnt from ${queryParam.queryTable}"
            + "<where>"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\" '>and user_type = #{queryParam.userType}</if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "</where>"
            + "group by province, isp"
            + "</script>")
    List<AnswerDistribution> findGroupByProvinceAndIsp(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select province, SUM(parse_total_cnt) as parse_total_cnt from ${queryParam.queryTable}"
            + "<where>"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\" '>and user_type = #{queryParam.userType}</if>"
            + "</where>"
            + "group by province"
            + "</script>")
    List<AnswerDistribution> findGroupByProvince(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select province,sum(parse_total_cnt) parse_total_cnt from ( "
            + "select province,sum(parse_total_cnt) parse_total_cnt from rpt_resource_answer_distribution_1min "
            + "<where>"
            + "parse_time &gt;= date_sub(minute,+30+toInt8OrZero(substring(formatDateTime(toDateTime(#{queryParam.endTime}),'%M'),2,1 )),date_trunc('minute',toDateTime(#{queryParam.endTime}))) "
            + "and parse_time &lt; date_sub(minute,-1,date_trunc('minute',toDateTime(#{queryParam.endTime}))) "
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\" '>and user_type = #{queryParam.userType}</if>"
            + "</where>"
            + "group by province "
            + "union all "
            + "select province,sum(parse_total_cnt) parse_total_cnt from rpt_resource_answer_distribution_10min "
            + "<where>"
            + "parse_time &gt;= date_sub(hour,+2,date_trunc('hour',toDateTime(#{queryParam.endTime}))) "
            + "and parse_time &lt; date_sub(minute,+30+toInt8OrZero(substring(formatDateTime(toDateTime(#{queryParam.endTime}),'%M'),2,1 )),date_trunc('minute',toDateTime(#{queryParam.endTime}))) "
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\" '>and user_type = #{queryParam.userType}</if>"
            + "</where>"
            + "group by province "
            + "union all "
            + "select province,sum(parse_total_cnt) parse_total_cnt from rpt_resource_answer_distribution_1h "
            + "<where>"
            + "parse_time &gt;= #{queryParam.startTime} "
            + "and parse_time &lt; date_sub(hour,+2,date_trunc('hour',toDateTime(#{queryParam.endTime}))) "
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\" '>and user_type = #{queryParam.userType}</if>"
            + "</where>"
            + "group by province) "
            + "group by province"
            + "</script>")
    List<AnswerDistribution> findGroupByProvinceToday(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select province, SUM(parse_total_cnt) AS parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by province "
            + "</script>")
    List<AnswerDistribution> findBySelectiveGroupByParseTimeAndProvinceAll(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select case when city='辖区' then district else city end as city, SUM(parse_total_cnt) AS parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by( case when city='辖区' then district else city end as city)"
            + "</script>")
    List<AnswerDistribution> findBySelectiveGroupByParseTimeAndCityAll(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select  province, SUM(parse_total_cnt) AS parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by province  limit #{queryParam.offset} , #{queryParam.limit}"
            + "</script>")
    List<AnswerDistribution> findBySelectiveGroupByParseTimeAndProvinceLimitNumAll(@Param("queryParam") AnswerDistributionBO queryParam);

    @Select("<script>"
            + "select  case when city='辖区' then district else city end as city, SUM(parse_total_cnt) AS parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by(case when city='辖区' then district else city end as city)   limit #{queryParam.offset} , #{queryParam.limit}"
            + "</script>")
    List<AnswerDistribution> findBySelectiveGroupByParseTimeAndCityLimitNumAll(@Param("queryParam") AnswerDistributionBO queryParam);

    @Select("<script>"
            + "select province, SUM(parse_total_cnt) AS parse_total_cnt from ${queryParam.queryTable} where 1=1"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "group by province order by parse_total_cnt desc"
            + "</script>")
    List<AnswerDistribution> findBySelectiveGroupByParseTimeAndProvinceAllPdf(@Param("queryParam") AnswerDistributionBO answerDistributionBO);

    @Select("<script>"
            + "select isp, SUM(parse_total_cnt) as parse_total_cnt from ${queryParam.queryTable}"
            + "<where>"
            + "<if test = 'queryParam.startTime != null'>and parse_time &gt;= #{queryParam.startTime} </if>"
            + "<if test = 'queryParam.endTime != null'>and parse_time &lt;= #{queryParam.endTime} </if>"
            + "<if test = 'queryParam.rankNumber != null'>and rank_number &lt;= #{queryParam.rankNumber} </if>"
            + "<if test = 'queryParam.parseTotalCnt != null'>and parse_total_cnt = #{queryParam.parseTotalCnt} </if>"
            + "<if test = 'queryParam.successCnt != null'>and success_cnt = #{queryParam.successCnt} </if>"
            + "<if test = 'queryParam.failCnt != null'>and fail_cnt = #{queryParam.failCnt} </if>"
            + "<if test = 'queryParam.businessIp != null and queryParam.businessIp != \"\"'>and business_ip = #{queryParam.businessIp} </if>"
            + "<if test = 'queryParam.districtsCode != null and queryParam.districtsCode != \"\"'>and districts_code like concat(#{queryParam.districtsCode},'%') </if>"
            + "<if test = 'queryParam.country != null and queryParam.country != \"\"'>and country = #{queryParam.country} </if>"
            + "<if test = 'queryParam.province != null and queryParam.province != \"\"'>and province = #{queryParam.province} </if>"
            + "<if test = 'queryParam.city != null and queryParam.city != \"\"'>and city = #{queryParam.city} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\" '>and user_type = #{queryParam.userType}</if>"
            + "<if test = 'queryParam.district != null and queryParam.district != \"\"'>and district = #{queryParam.district} </if>"
            + "<if test = 'queryParam.userType != null and queryParam.userType != \"\"'>and user_type = #{queryParam.userType} </if>"
            + "<if test = 'queryParam.answerFirstIsp != null and queryParam.answerFirstIsp != \"\"'>and isp = #{queryParam.answerFirstIsp} </if>"
            + "<if test = 'queryParam.answerFirstIpDistrictsName != null and queryParam.answerFirstIpDistrictsName != \"\"'>and answer_first_ip_districts_name = #{queryParam.answerFirstIpDistrictsName} </if>"
            + "</where>"
            + "group by isp order by parse_total_cnt desc"
            + "</script>")
    List<AnswerDistribution> findGroupByIsp(@Param("queryParam") AnswerDistributionBO answerDistributionBO);
}
